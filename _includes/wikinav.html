<!-- Menu toggle -->
<a href="#menu" id="menuLink" class="menu-link">
    <!-- Hamburger icon -->
    <span></span>
</a>

<div id="menu">
    <div class="pure-menu">
        <a class="pure-menu-heading" href="#">Menu</a>
        {% assign lang_array = "en|ru" | split: "|" %}
        {% assign items = site.wiki | sort: "wid" | where:"lang",page.lang %}
        {% include lang-switcher.html %}
        <ul class="pure-menu-list">
            {% assign pageChunks = page.url | split:"/" %}
            {% assign pageChunksSize = pageChunks | size %}
            {% if pageChunksSize > 4 %}
            <li class="pure-menu-item">
                <a class="pure-menu-link " href="../">..</a>
            </li>
            {% endif %}
            {% for p in items %}
                <span>
                {% assign pChunks = p.url | split:"/" %}
                {% assign pChunksSize = pChunks | size %}

                {% if pageChunksSize > pChunksSize %}
                    {% assign minSize = pChunksSize %}
                {% else %}
                    {% assign minSize = pageChunksSize %}
                {% endif %}

                {% assign length = minSize | minus: 1 %}

                {% assign showPage = 1 %}
                {% for chunkIndex in (0..length) %}
                    {% if pChunks[chunkIndex] != pageChunks[chunkIndex] %}
                        {% if showPage == 1 %}
                            {% if chunkIndex < length %}
                                {% assign showPage = 0 %}
                            {% else if chunkIndex == length %}
                                {% if pChunksSize == pageChunksSize %}
                                    {% assign showPage = 1 %}
                                {% else %}
                                    {% assign nextChunkIndex = chunkIndex | plus: 1 %}
                                    {% if pChunks[nextChunkIndex] == "index.html" %}
                                        {% assign showPage = 1 %}
                                    {% else %}
                                        {% assign showPage = 0 %}
                                    {% endif %}
                                {% endif %}
                            {% endif %}
                        {% endif %}
                    {% endif %}
                    <!--//
                    a: {{ pChunks[chunkIndex] }}
                    b: {{ pageChunks[chunkIndex] }}<br>
                    //-->
                {% endfor %}
                </span>
                {% if showPage == 1 %}
                    <li class="pure-menu-item">
                        <a class="pure-menu-link {% if p.url == page.url %}active{% endif %}" href="{{ relative-baseurl }}{{ p.url | replace_first:'/',''}}">{{ p.title }}</a>
                    </li>
                {% endif %}
            {% endfor %}
        </ul>
    </div> <!--// .pure-menu //-->
</div> <!--// #menu //-->
